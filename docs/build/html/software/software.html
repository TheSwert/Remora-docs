

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Software &mdash; Remora documentation 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Firmware" href="../firmware/firmware.html" />
    <link rel="prev" title="Re-ARM" href="../hardware/Re-ARM.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Remora documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">Overview</a></li>
</ul>
<p class="caption"><span class="caption-text">Hardware</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hardware/hardware.html">Hardware</a></li>
</ul>
<p class="caption"><span class="caption-text">Software</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Software</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#linuxcnc-basics">LinuxCNC basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#linuxcnc-task-threads">LinuxCNC task threads</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hardware-abstraction-layer-hal">Hardware Abstraction Layer (HAL)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#linuxcnc-installation">LinuxCNC installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#remora-installation">Remora installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#linuxcnc-configuration">LinuxCNC configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#e-stop-loop">E-Stop Loop</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Firmware</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware/firmware.html">Firmware</a></li>
</ul>
<p class="caption"><span class="caption-text">Development Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/development.html">Development</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Remora documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Software</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/software/software.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="software">
<h1>Software<a class="headerlink" href="#software" title="Permalink to this headline">¶</a></h1>
<p>In this section of the Remora documentation, the installation, setup and configuration of LinuxCNC and the Remora component are covered.</p>
<div class="section" id="linuxcnc-basics">
<h2>LinuxCNC basics<a class="headerlink" href="#linuxcnc-basics" title="Permalink to this headline">¶</a></h2>
<p>LinuxCNC is well documented, but there are some key concepts of LinuxCNC that are important to know so that we can understand why the Remora component was developed and how it off loads tasks that a traditional parallel port stepper based LinuxCNC setup would do.</p>
<div class="section" id="linuxcnc-task-threads">
<h3>LinuxCNC task threads<a class="headerlink" href="#linuxcnc-task-threads" title="Permalink to this headline">¶</a></h3>
<p>In LinuxCNC, a thread is a list of functions that runs at specific intervals as part of a realtime task. When a thread is first created, it has a specific time interval (period), but no functions. Functions are added to the thread, and these will be executed in order every time the thread runs. In a traditional stepper configuration, two threads a created:</p>
<ul class="simple">
<li><p>Base Thread - a short period (high frequency) thread that is used for software step generation.</p></li>
<li><p>Servo Thread - a longer period (lower frequency) thread tha is used for calculating motor positions, checking IO and logic functions</p></li>
</ul>
<p>The Remora component allows the Base Thread tasks to be off loaded to the controller board</p>
</div>
<div class="section" id="hardware-abstraction-layer-hal">
<h3>Hardware Abstraction Layer (HAL)<a class="headerlink" href="#hardware-abstraction-layer-hal" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="linuxcnc-installation">
<h2>LinuxCNC installation<a class="headerlink" href="#linuxcnc-installation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="remora-installation">
<h3>Remora installation<a class="headerlink" href="#remora-installation" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="linuxcnc-configuration">
<h2>LinuxCNC configuration<a class="headerlink" href="#linuxcnc-configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="e-stop-loop">
<h3>E-Stop Loop<a class="headerlink" href="#e-stop-loop" title="Permalink to this headline">¶</a></h3>
<p>To alert and stop LinuxCNC if SPI communication with the controller board cannot be estabilished, or if it is lost during operation, the Remora component is included as part of the LinuxCNC E-Stop loop. The HAL configuration is shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># estop loopback, SPI comms enable and feedback</span>

<span class="n">net</span> <span class="n">user</span><span class="o">-</span><span class="n">enable</span><span class="o">-</span><span class="n">out</span>     <span class="o">&lt;=</span> <span class="n">iocontrol</span><span class="o">.</span><span class="mf">0.</span><span class="n">user</span><span class="o">-</span><span class="n">enable</span><span class="o">-</span><span class="n">out</span>      <span class="o">=&gt;</span> <span class="n">remora</span><span class="o">.</span><span class="n">SPI</span><span class="o">-</span><span class="n">enable</span>
<span class="n">net</span> <span class="n">user</span><span class="o">-</span><span class="n">request</span><span class="o">-</span><span class="n">enable</span> <span class="o">&lt;=</span> <span class="n">iocontrol</span><span class="o">.</span><span class="mf">0.</span><span class="n">user</span><span class="o">-</span><span class="n">request</span><span class="o">-</span><span class="n">enable</span>  <span class="o">=&gt;</span> <span class="n">remora</span><span class="o">.</span><span class="n">SPI</span><span class="o">-</span><span class="n">reset</span>
<span class="n">net</span> <span class="n">remora</span><span class="o">-</span><span class="n">status</span>       <span class="o">&lt;=</span> <span class="n">remora</span><span class="o">.</span><span class="n">SPI</span><span class="o">-</span><span class="n">status</span>                <span class="o">=&gt;</span> <span class="n">iocontrol</span><span class="o">.</span><span class="mf">0.</span><span class="n">emc</span><span class="o">-</span><span class="n">enable</span><span class="o">-</span><span class="ow">in</span>
</pre></div>
</div>
<p>Diagramatically this is shown in the following figure.</p>
<img alt="../_images/hal-estop.png" src="../_images/hal-estop.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>TODO - include the ability to have a physical E-Stop wired to the controller board.</dt><dd><ul class="simple">
<li><p>E-Stop to be a normally closed switch</p></li>
<li><p>Json config to turn feature on</p></li>
<li><p>new module needed to monitor input pin and halt SPI on E-Stop activation (pin going low)</p></li>
</ul>
</dd>
</dl>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../firmware/firmware.html" class="btn btn-neutral float-right" title="Firmware" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../hardware/Re-ARM.html" class="btn btn-neutral float-left" title="Re-ARM" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Scott Alford.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>